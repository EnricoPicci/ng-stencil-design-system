# üöÄ Phase 5: Build & Deployment
## Production Optimization & Deployment Pipeline

**Duration**: 1 day  
**Objective**: Optimize for production, configure deployment pipeline, and launch application  
**Dependencies**: Phase 4 Complete (All tests passing, quality gates met)  
**Final Phase**: Complete production-ready application

---

## üéØ Phase 5 Objectives

- ‚úÖ Configure production builds with optimization
- ‚úÖ Set up CI/CD pipeline with GitHub Actions
- ‚úÖ Implement deployment strategies (Vercel, Netlify, AWS)
- ‚úÖ Configure monitoring and analytics
- ‚úÖ Optimize bundle size and performance
- ‚úÖ Set up error tracking and logging
- ‚úÖ Create deployment documentation
- ‚úÖ Launch production application

---

## üèóÔ∏è Production Build Configuration Using Angular CLI

### Angular CLI Build Commands

Since we created the Angular app with `ng new`, all build configurations are already optimized. Use Angular CLI commands directly:

```bash
cd packages/todo-app

# Development build
ng build

# Production build (Angular CLI optimized)
ng build --configuration production

# Build with source maps for debugging
ng build --configuration production --source-map

# Build with bundle analysis
ng build --configuration production --stats-json

# Serve production build locally for testing
ng build --configuration production && npx http-server dist/todo-app -p 8080
```

### Root package.json (Updated for Angular CLI)
```json
{
  "scripts": {
    "build": "npm run build:design-system && ng build -w packages/todo-app",
    "build:design-system": "npm run build -w packages/design-system",
    "build:prod": "npm run build:design-system && ng build --configuration production -w packages/todo-app",
    "build:analyze": "ng build --configuration production --stats-json -w packages/todo-app && npm run analyze:bundle",
    "prebuild": "npm run lint && npm run test:ci",
    "preview": "npm run build:prod && npx http-server packages/todo-app/dist/todo-app -p 8080 -c-1",
    "deploy:preview": "npm run build:prod && npm run deploy:staging",
    "deploy:production": "npm run build:prod && npm run deploy:prod"
  }
}
```

### Angular CLI Production Optimizations (Automatically Configured)

Angular CLI `ng new` already configures optimal production settings in `angular.json`:

### Angular Production Configuration

#### angular.json (Production optimizations)
```json
{
  "projects": {
    "todo-app": {
      "architect": {
        "build": {
          "configurations": {
            "production": {
              "budgets": [
                {
                  "type": "initial",
                  "maximumWarning": "500kb",
                  "maximumError": "1mb"
                },
                {
                  "type": "anyComponentStyle", 
                  "maximumWarning": "2kb",
                  "maximumError": "4kb"
                }
              ],
              "outputHashing": "all",
              "optimization": true,
              "sourceMap": false,
              "namedChunks": false,
              "extractLicenses": true,
              "vendorChunk": false,
              "buildOptimizer": true,
              "serviceWorker": true,
              "ngswConfigPath": "ngsw-config.json",
              "fileReplacements": [
                {
                  "replace": "src/environments/environment.ts",
                  "with": "src/environments/environment.prod.ts"
                }
              ]
            },
            "staging": {
              "optimization": true,
              "sourceMap": true,
              "namedChunks": true,
              "extractLicenses": true,
              "vendorChunk": true,
              "buildOptimizer": true,
              "fileReplacements": [
                {
                  "replace": "src/environments/environment.ts", 
                  "with": "src/environments/environment.staging.ts"
                }
              ]
            }
          }
        }
      }
    }
  }
}
```

### Environment Configuration Using Angular CLI

```bash
cd packages/todo-app

# Generate additional environment files if needed
ng generate environments

# This creates or updates:
# src/environments/environment.ts
# src/environments/environment.development.ts  
# src/environments/environment.production.ts
```

#### Update environment.prod.ts (Generated by Angular CLI)
```typescript
export const environment = {
  production: true,
  name: 'production',
  version: '1.0.0',
  api: {
    baseUrl: 'https://api.todo-app.com',
    timeout: 30000
  },
  monitoring: {
    sentry: {
      dsn: process.env['SENTRY_DSN'] || '',
      environment: 'production',
      release: process.env['APP_VERSION'] || '1.0.0'
    },
    analytics: {
      googleAnalyticsId: process.env['GA_TRACKING_ID'] || '',
      enabled: true
    }
  },
  features: {
    enableServiceWorker: true,
    enablePushNotifications: false,
    enableOfflineMode: true
  },
  build: {
    timestamp: Date.now(),
    commit: process.env['GITHUB_SHA'] || 'unknown'
  }
};
```

#### environment.staging.ts
```typescript
export const environment = {
  production: false,
  name: 'staging',
  version: '1.0.0-staging',
  api: {
    baseUrl: 'https://staging-api.todo-app.com',
    timeout: 30000
  },
  monitoring: {
    sentry: {
      dsn: process.env['SENTRY_DSN'] || '',
      environment: 'staging',
      release: process.env['APP_VERSION'] || '1.0.0-staging'
    },
    analytics: {
      googleAnalyticsId: process.env['GA_TRACKING_ID'] || '',
      enabled: false
    }
  },
  features: {
    enableServiceWorker: false,
    enablePushNotifications: false,
    enableOfflineMode: true
  },
  build: {
    timestamp: Date.now(),
    commit: process.env['GITHUB_SHA'] || 'unknown'
  }
};
```

---

## üîÑ CI/CD Pipeline with GitHub Actions

### Main CI/CD Workflow

#### .github/workflows/ci-cd.yml
```yaml
name: CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

env:
  NODE_VERSION: '18'
  CACHE_VERSION: 'v1'

jobs:
  # Quality Gates
  quality:
    name: Quality Gates
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Lint code
        run: npm run lint

      - name: Type check
        run: npm run typecheck

      - name: Run unit tests
        run: npm run test:ci

      - name: Build packages
        run: npm run build

      - name: Upload build artifacts
        uses: actions/upload-artifact@v4
        with:
          name: build-artifacts
          path: |
            packages/design-system/dist
            packages/todo-app/dist
          retention-days: 7

  # E2E Testing
  e2e:
    name: E2E Tests
    runs-on: ubuntu-latest
    needs: quality
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Download build artifacts
        uses: actions/download-artifact@v4
        with:
          name: build-artifacts

      - name: Start application
        run: |
          npm run serve:prod &
          npx wait-on http://localhost:8080

      - name: Run Cypress tests
        uses: cypress-io/github-action@v6
        with:
          wait-on: 'http://localhost:8080'
          wait-on-timeout: 120
          browser: chrome
          record: true
        env:
          CYPRESS_RECORD_KEY: ${{ secrets.CYPRESS_RECORD_KEY }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Upload Cypress screenshots
        uses: actions/upload-artifact@v4
        if: failure()
        with:
          name: cypress-screenshots
          path: cypress/screenshots

  # Performance & Accessibility
  lighthouse:
    name: Lighthouse Audit
    runs-on: ubuntu-latest
    needs: quality
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Download build artifacts
        uses: actions/download-artifact@v4
        with:
          name: build-artifacts

      - name: Start application
        run: |
          npm run serve:prod &
          npx wait-on http://localhost:8080

      - name: Run Lighthouse CI
        run: npx lhci autorun
        env:
          LHCI_GITHUB_APP_TOKEN: ${{ secrets.LHCI_GITHUB_APP_TOKEN }}

      - name: Upload Lighthouse reports
        uses: actions/upload-artifact@v4
        with:
          name: lighthouse-reports
          path: ./reports/lighthouse

  # Security Scanning
  security:
    name: Security Scan
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Run npm audit
        run: npm audit --audit-level=moderate

      - name: Run Snyk security scan
        uses: snyk/actions/node@master
        env:
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
        with:
          args: --severity-threshold=high

      - name: Upload Snyk results
        uses: github/codeql-action/upload-sarif@v3
        if: always()
        with:
          sarif_file: snyk.sarif

  # Deploy to Staging
  deploy-staging:
    name: Deploy to Staging
    runs-on: ubuntu-latest
    needs: [quality, e2e, lighthouse]
    if: github.ref == 'refs/heads/develop'
    environment:
      name: staging
      url: https://staging.todo-app.com
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Build for staging
        run: npm run build:prod
        env:
          NODE_ENV: staging
          SENTRY_DSN: ${{ secrets.SENTRY_DSN }}
          GA_TRACKING_ID: ${{ secrets.GA_TRACKING_ID_STAGING }}

      - name: Deploy to Vercel
        uses: vercel/action@v1
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          working-directory: packages/todo-app/dist
          alias: staging.todo-app.com

  # Deploy to Production
  deploy-production:
    name: Deploy to Production
    runs-on: ubuntu-latest
    needs: [quality, e2e, lighthouse, security]
    if: github.ref == 'refs/heads/main'
    environment:
      name: production
      url: https://todo-app.com
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Build for production
        run: npm run build:prod
        env:
          NODE_ENV: production
          SENTRY_DSN: ${{ secrets.SENTRY_DSN }}
          GA_TRACKING_ID: ${{ secrets.GA_TRACKING_ID }}
          APP_VERSION: ${{ github.sha }}

      - name: Deploy to Vercel
        uses: vercel/action@v1
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          working-directory: packages/todo-app/dist
          prod: true

      - name: Notify deployment
        uses: 8398a7/action-slack@v3
        with:
          status: ${{ job.status }}
          channel: '#deployments'
          webhook_url: ${{ secrets.SLACK_WEBHOOK }}
        if: always()
```

### Release Workflow

#### .github/workflows/release.yml
```yaml
name: Release

on:
  push:
    tags:
      - 'v*.*.*'

jobs:
  release:
    name: Create Release
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Build packages
        run: npm run build:prod

      - name: Generate changelog
        id: changelog
        uses: conventional-changelog/action@v3
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          output-file: 'CHANGELOG.md'

      - name: Create GitHub Release
        uses: actions/create-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: ${{ github.ref }}
          release_name: Release ${{ github.ref }}
          body: ${{ steps.changelog.outputs.changelog }}
          draft: false
          prerelease: false

      - name: Deploy to production
        run: npm run deploy:production
        env:
          VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}
          SENTRY_DSN: ${{ secrets.SENTRY_DSN }}
```

---

## üåê Deployment Configurations

### Vercel Deployment

#### vercel.json
```json
{
  "version": 2,
  "name": "todo-app",
  "builds": [
    {
      "src": "packages/todo-app/dist/**",
      "use": "@vercel/static"
    }
  ],
  "routes": [
    {
      "src": "/(.*)",
      "dest": "/packages/todo-app/dist/index.html"
    }
  ],
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        {
          "key": "X-Content-Type-Options",
          "value": "nosniff"
        },
        {
          "key": "X-Frame-Options",
          "value": "DENY"
        },
        {
          "key": "X-XSS-Protection",
          "value": "1; mode=block"
        },
        {
          "key": "Referrer-Policy",
          "value": "strict-origin-when-cross-origin"
        },
        {
          "key": "Content-Security-Policy",
          "value": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' https: data:; connect-src 'self' https:;"
        }
      ]
    },
    {
      "source": "/(.*\\.(js|css|png|jpg|jpeg|gif|ico|svg))",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=31536000, immutable"
        }
      ]
    }
  ],
  "functions": {
    "packages/todo-app/dist/index.html": {
      "includeFiles": "packages/todo-app/dist/**"
    }
  }
}
```

### Netlify Deployment

#### netlify.toml
```toml
[build]
  base = "packages/todo-app"
  publish = "dist"
  command = "npm run build:prod"

[build.environment]
  NODE_VERSION = "18"
  NPM_FLAGS = "--prefix=/opt/buildhome/.node_modules"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Content-Security-Policy = "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' https: data:; connect-src 'self' https:;"

[[headers]]
  for = "*.js"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "*.css"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "*.png"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "*.jpg"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "*.svg"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
```

### Docker Deployment

#### Dockerfile
```dockerfile
# Multi-stage build for optimized production image

# Build stage
FROM node:18-alpine AS builder

WORKDIR /app

# Copy package files
COPY package*.json ./
COPY packages/design-system/package*.json ./packages/design-system/
COPY packages/todo-app/package*.json ./packages/todo-app/

# Install dependencies
RUN npm ci --only=production

# Copy source code
COPY . .

# Build applications
RUN npm run build:prod

# Production stage
FROM nginx:1.25-alpine

# Copy custom nginx config
COPY docker/nginx.conf /etc/nginx/nginx.conf

# Copy built application
COPY --from=builder /app/packages/todo-app/dist /usr/share/nginx/html

# Add health check
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:80/ || exit 1

# Expose port
EXPOSE 80

# Start nginx
CMD ["nginx", "-g", "daemon off;"]
```

#### docker/nginx.conf
```nginx
events {
    worker_connections 1024;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    # Gzip compression
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_types
        text/plain
        text/css
        text/xml
        text/javascript
        application/json
        application/javascript
        application/xml+rss
        application/atom+xml
        image/svg+xml;

    # Security headers
    add_header X-Frame-Options DENY always;
    add_header X-Content-Type-Options nosniff always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header Referrer-Policy "strict-origin-when-cross-origin" always;

    server {
        listen 80;
        server_name localhost;
        root /usr/share/nginx/html;
        index index.html;

        # Enable caching for static assets
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }

        # Handle SPA routing
        location / {
            try_files $uri $uri/ /index.html;
        }

        # Health check endpoint
        location /health {
            access_log off;
            return 200 "healthy\n";
        }
    }
}
```

#### docker-compose.yml
```yaml
version: '3.8'

services:
  todo-app:
    build: .
    ports:
      - "3000:80"
    environment:
      - NODE_ENV=production
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:80/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.todo-app.rule=Host(`todo-app.com`)"
      - "traefik.http.routers.todo-app.tls=true"
      - "traefik.http.routers.todo-app.tls.certresolver=letsencrypt"

networks:
  default:
    external:
      name: web
```

---

## üìä Monitoring & Analytics

### Error Tracking with Sentry

#### sentry.config.ts
```typescript
import { enableProdMode } from '@angular/core';
import * as Sentry from '@sentry/angular';
import { environment } from './environments/environment';

if (environment.production) {
  enableProdMode();
  
  Sentry.init({
    dsn: environment.monitoring.sentry.dsn,
    environment: environment.monitoring.sentry.environment,
    release: environment.monitoring.sentry.release,
    integrations: [
      new Sentry.BrowserTracing({
        routingInstrumentation: Sentry.routingInstrumentation,
      }),
    ],
    tracesSampleRate: environment.production ? 0.1 : 1.0,
    beforeSend(event) {
      // Filter out non-critical errors in production
      if (environment.production && event.level === 'info') {
        return null;
      }
      return event;
    },
  });
}
```

### Application Monitoring Service

#### monitoring.service.ts
```typescript
import { Injectable } from '@angular/core';
import * as Sentry from '@sentry/angular';
import { environment } from '../environments/environment';

export interface PerformanceMetrics {
  loadTime: number;
  renderTime: number;
  interactionTime: number;
}

@Injectable({ providedIn: 'root' })
export class MonitoringService {
  
  /**
   * Track custom performance metrics
   */
  trackPerformance(metrics: PerformanceMetrics): void {
    if (environment.production) {
      Sentry.addBreadcrumb({
        category: 'performance',
        data: metrics,
        level: 'info'
      });
    }
  }

  /**
   * Track user interactions
   */
  trackUserAction(action: string, data?: any): void {
    if (environment.production) {
      Sentry.addBreadcrumb({
        category: 'user-action',
        message: action,
        data,
        level: 'info'
      });
    }
  }

  /**
   * Track application errors
   */
  trackError(error: Error, context?: any): void {
    console.error('Application Error:', error, context);
    
    if (environment.production) {
      Sentry.withScope((scope) => {
        if (context) {
          scope.setContext('error-context', context);
        }
        Sentry.captureException(error);
      });
    }
  }

  /**
   * Track todo-specific metrics
   */
  trackTodoMetrics(action: 'add' | 'edit' | 'delete' | 'toggle', todoCount: number): void {
    this.trackUserAction(`todo-${action}`, { 
      totalTodos: todoCount,
      timestamp: new Date().toISOString()
    });
  }

  /**
   * Set user context
   */
  setUserContext(userId: string, properties?: any): void {
    if (environment.production) {
      Sentry.setUser({
        id: userId,
        ...properties
      });
    }
  }

  /**
   * Track page views (for SPA)
   */
  trackPageView(pageName: string): void {
    if (environment.production && environment.monitoring.analytics.enabled) {
      // Google Analytics 4
      if (typeof gtag !== 'undefined') {
        gtag('config', environment.monitoring.analytics.googleAnalyticsId, {
          page_title: pageName,
          page_location: window.location.href
        });
      }
    }
  }
}
```

### Real User Monitoring (RUM)

#### performance.service.ts
```typescript
import { Injectable } from '@angular/core';
import { MonitoringService } from './monitoring.service';

@Injectable({ providedIn: 'root' })
export class PerformanceService {
  
  constructor(private monitoring: MonitoringService) {
    this.setupPerformanceObserver();
  }

  private setupPerformanceObserver(): void {
    if ('PerformanceObserver' in window) {
      // Largest Contentful Paint
      const lcpObserver = new PerformanceObserver((list) => {
        const entries = list.getEntries();
        const lastEntry = entries[entries.length - 1];
        this.monitoring.trackPerformance({
          loadTime: lastEntry.startTime,
          renderTime: lastEntry.renderTime || 0,
          interactionTime: 0
        });
      });
      lcpObserver.observe({ entryTypes: ['largest-contentful-paint'] });

      // First Input Delay
      const fidObserver = new PerformanceObserver((list) => {
        const entries = list.getEntries();
        entries.forEach(entry => {
          this.monitoring.trackPerformance({
            loadTime: 0,
            renderTime: 0,
            interactionTime: entry.processingStart - entry.startTime
          });
        });
      });
      fidObserver.observe({ entryTypes: ['first-input'] });

      // Cumulative Layout Shift
      let clsValue = 0;
      const clsObserver = new PerformanceObserver((list) => {
        for (const entry of list.getEntries()) {
          if (!entry.hadRecentInput) {
            clsValue += entry.value;
          }
        }
        
        if (clsValue > 0.1) { // CLS threshold
          this.monitoring.trackError(
            new Error(`High Cumulative Layout Shift: ${clsValue}`),
            { metric: 'cls', value: clsValue }
          );
        }
      });
      clsObserver.observe({ entryTypes: ['layout-shift'] });
    }
  }

  /**
   * Measure custom timing
   */
  measureTiming(name: string, startTime: number): void {
    const duration = performance.now() - startTime;
    performance.mark(`${name}-end`);
    performance.measure(name, `${name}-start`, `${name}-end`);
    
    this.monitoring.trackPerformance({
      loadTime: duration,
      renderTime: 0,
      interactionTime: 0
    });
  }

  /**
   * Start timing measurement
   */
  startTiming(name: string): number {
    const startTime = performance.now();
    performance.mark(`${name}-start`);
    return startTime;
  }
}
```

---

### PWA Configuration Using Angular CLI

```bash
cd packages/todo-app

# Add PWA support using Angular CLI (optional)
ng add @angular/pwa

# This automatically:
# - Adds service worker support
# - Creates app manifest.json  
# - Adds app icons
# - Configures PWA build settings
# - Updates index.html with PWA meta tags
```

## üìà Bundle Analysis & Optimization Using Angular CLI

### Angular CLI Bundle Analysis Commands

```bash
cd packages/todo-app

# Generate bundle statistics with Angular CLI
ng build --configuration production --stats-json

# Analyze bundle with webpack-bundle-analyzer
npx webpack-bundle-analyzer dist/todo-app/stats.json

# Check bundle budgets (configured in angular.json)
ng build --configuration production
# Angular CLI will warn if bundles exceed configured limits

# Analyze specific chunks
ng build --configuration production --named-chunks --verbose
```

### Bundle Analysis Scripts (Enhanced with Angular CLI)

#### scripts/analyze-bundle.js
```javascript
const { execSync } = require('child_process');
const fs = require('fs');
const path = require('path');

// Build the application
console.log('Building application for analysis...');
execSync('npm run build:prod', { stdio: 'inherit' });

// Generate bundle stats
console.log('Generating bundle statistics...');
execSync('npx webpack-bundle-analyzer packages/todo-app/dist/stats.json --mode static --report packages/todo-app/dist/bundle-report.html', { stdio: 'inherit' });

// Analyze bundle size
const distPath = path.join(__dirname, '../packages/todo-app/dist');
const files = fs.readdirSync(distPath);

const jsFiles = files.filter(file => file.endsWith('.js'));
const cssFiles = files.filter(file => file.endsWith('.css'));

let totalJSSize = 0;
let totalCSSSize = 0;

jsFiles.forEach(file => {
  const filePath = path.join(distPath, file);
  const stats = fs.statSync(filePath);
  totalJSSize += stats.size;
  console.log(`JS: ${file} - ${(stats.size / 1024).toFixed(2)} KB`);
});

cssFiles.forEach(file => {
  const filePath = path.join(distPath, file);
  const stats = fs.statSync(filePath);
  totalCSSSize += stats.size;
  console.log(`CSS: ${file} - ${(stats.size / 1024).toFixed(2)} KB`);
});

console.log('\n--- Bundle Size Summary ---');
console.log(`Total JS: ${(totalJSSize / 1024).toFixed(2)} KB`);
console.log(`Total CSS: ${(totalCSSSize / 1024).toFixed(2)} KB`);
console.log(`Total: ${((totalJSSize + totalCSSSize) / 1024).toFixed(2)} KB`);

// Check bundle size thresholds
const maxSizeKB = 512; // 512KB threshold
const totalSizeKB = (totalJSSize + totalCSSSize) / 1024;

if (totalSizeKB > maxSizeKB) {
  console.error(`\n‚ùå Bundle size ${totalSizeKB.toFixed(2)}KB exceeds threshold ${maxSizeKB}KB`);
  process.exit(1);
} else {
  console.log(`\n‚úÖ Bundle size ${totalSizeKB.toFixed(2)}KB within threshold ${maxSizeKB}KB`);
}
```

### Service Worker Configuration

#### ngsw-config.json
```json
{
  "$schema": "./node_modules/@angular/service-worker/config/schema.json",
  "index": "/index.html",
  "assetGroups": [
    {
      "name": "app",
      "installMode": "prefetch",
      "resources": {
        "files": [
          "/favicon.ico",
          "/index.html",
          "/manifest.json",
          "/*.css",
          "/*.js"
        ]
      }
    },
    {
      "name": "assets",
      "installMode": "lazy",
      "updateMode": "prefetch",
      "resources": {
        "files": [
          "/assets/**",
          "/*.(eot|svg|cur|jpg|png|webp|gif|otf|ttf|woff|woff2|ani)"
        ]
      }
    }
  ],
  "dataGroups": [
    {
      "name": "api-cache",
      "urls": [
        "/api/**"
      ],
      "cacheConfig": {
        "strategy": "performance",
        "maxSize": 100,
        "maxAge": "1h"
      }
    }
  ]
}
```

---

## üìù Documentation & Deployment Guides

### Deployment Documentation

#### docs/DEPLOYMENT.md
```markdown
# Deployment Guide

## Prerequisites

- Node.js 18+
- npm 9+
- Git access to repository
- Access to deployment platform (Vercel/Netlify/AWS)

## Environment Variables

### Required for Production

```bash
NODE_ENV=production
SENTRY_DSN=https://your-sentry-dsn
GA_TRACKING_ID=GA-XXXXXXXXX
APP_VERSION=1.0.0
```

### Required for CI/CD

```bash
VERCEL_TOKEN=your-vercel-token
VERCEL_ORG_ID=your-org-id
VERCEL_PROJECT_ID=your-project-id
CYPRESS_RECORD_KEY=your-cypress-key
SNYK_TOKEN=your-snyk-token
```

## Deployment Steps

### Manual Deployment

```bash
# 1. Install dependencies
npm ci

# 2. Run quality checks
npm run lint
npm run test:ci

# 3. Build for production
npm run build:prod

# 4. Deploy to platform
npm run deploy:production
```

### Automated Deployment

Deployments are automated via GitHub Actions:

- **Staging**: Automatically deployed on push to `develop` branch
- **Production**: Automatically deployed on push to `main` branch
- **Releases**: Tagged releases trigger production deployment

## Monitoring

- **Application**: https://sentry.io/your-project
- **Performance**: https://vercel.com/analytics
- **Uptime**: https://uptimerobot.com

## Rollback Procedure

1. Identify the last known good deployment
2. Revert the problematic commit
3. Push to main branch to trigger new deployment
4. Verify application functionality

## Troubleshooting

### Build Failures

- Check Node.js version compatibility
- Clear npm cache: `npm cache clean --force`
- Delete node_modules: `rm -rf node_modules && npm ci`

### Deployment Failures

- Verify environment variables are set
- Check build artifacts are generated
- Review deployment logs in platform dashboard

### Performance Issues

- Run bundle analysis: `npm run analyze:bundle`
- Check Lighthouse report: `npm run analyze:performance`
- Review Sentry performance monitoring
```

### Operational Runbook

#### docs/OPERATIONS.md
```markdown
# Operations Runbook

## Health Checks

### Application Health
- URL: https://todo-app.com/health
- Expected: 200 OK with "healthy" response

### Performance Monitoring
- Core Web Vitals should be green
- Lighthouse score > 90
- Error rate < 1%

## Incident Response

### High Error Rate (>5%)

1. Check Sentry dashboard for error patterns
2. Review recent deployments
3. Check application logs
4. Consider rollback if critical

### Performance Degradation

1. Check Core Web Vitals metrics
2. Review bundle size changes
3. Check CDN and hosting performance
4. Analyze user experience impact

### Outage Response

1. Verify hosting platform status
2. Check DNS resolution
3. Review SSL certificate status
4. Implement status page updates

## Maintenance

### Weekly Tasks
- Review error trends in Sentry
- Check performance metrics
- Update dependencies (security patches)

### Monthly Tasks
- Security audit with npm audit
- Performance review and optimization
- Backup verification
- Dependency updates

### Quarterly Tasks
- Framework updates (Angular, Stencil)
- Architecture review
- Capacity planning
- Security assessment
```

---

## ‚úÖ Success Criteria

### Phase 5 Complete When:
- [ ] **Production Build**: Optimized builds working correctly
- [ ] **CI/CD Pipeline**: GitHub Actions pipeline functional
- [ ] **Deployment**: Application deployed to production
- [ ] **Monitoring**: Error tracking and analytics configured
- [ ] **Performance**: Bundle size optimized (<512KB)
- [ ] **Security**: Security headers and HTTPS configured
- [ ] **Documentation**: Deployment guides complete
- [ ] **Health Checks**: Application monitoring active

### Validation Commands:
```bash
# Build production application
npm run build:prod

# Analyze bundle size
npm run analyze:bundle

# Test deployment
npm run deploy:preview

# Run full test suite
npm run test:all

# Performance audit
npm run analyze:performance
```

---

## üìã Phase 5 Checklist

- [ ] Configure production build optimizations
- [ ] Set up CI/CD pipeline with GitHub Actions
- [ ] Configure deployment to Vercel/Netlify
- [ ] Set up error tracking with Sentry
- [ ] Implement performance monitoring
- [ ] Configure security headers and CSP
- [ ] Set up analytics tracking
- [ ] Create deployment documentation
- [ ] Configure health checks and alerts
- [ ] Test rollback procedures
- [ ] Optimize bundle size and performance
- [ ] Launch production application

---

## üéØ Project Completion

### Final Deliverables
‚úÖ **Complete Todo Application**: Angular 19 + Stencil design system  
‚úÖ **Production Deployment**: Live application at production URL  
‚úÖ **CI/CD Pipeline**: Automated testing and deployment  
‚úÖ **Monitoring & Analytics**: Error tracking and performance monitoring  
‚úÖ **Documentation**: Complete setup, deployment, and operations guides  

### Success Metrics Met
- **Performance**: Core Web Vitals green, bundle <512KB
- **Quality**: 95%+ test coverage, zero critical issues
- **Accessibility**: WCAG 2.1 AA compliance
- **Security**: Security headers, dependency scanning
- **Monitoring**: Error tracking, performance monitoring active

**üöÄ Todo Application Successfully Deployed to Production!**